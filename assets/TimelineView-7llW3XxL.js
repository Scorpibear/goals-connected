import{_ as M,r as _,o as D,a as r,c,e as u,F as C,b as k,t as b,f as j,n as V,d as h,G as x,A as O,g as S,h as A,B}from"./index-TLdBQAKw.js";const F={__name:"GoalsTimeline",props:{initGoals:{type:Array,default(){return[{title:"Week",goals:[]},{title:"Month",goals:[]}]}},backend:Object},emits:["dateChange"],setup(p,{expose:a,emit:f}){a();const e=p,m=_(void 0),s=_(void 0),t=S,d=f,g=l=>new Date((Date.parse(l==null?void 0:l.end)||Date.now())-1).toISOString().split("T")[0];function n(l,i,o,w){let y=l[o],L=y.goals.findIndex(({id:P})=>P==i.id);y.goals.splice(L,1);let T=l[w];i.targetDate=g(T),T.goals.push(i),e.backend.updateGoal(i)}function v(l,i,o){switch(i){case"right":o<s.value.length-1&&n(s.value,l,o,o+1);break;case"left":o>0&&n(s.value,l,o,o-1);break;default:console.error("Unsupported direction: ",i)}}D(async()=>{var l,i;try{s.value=(l=e.backend)!=null&&l.getTimeline?await e.backend.getTimeline():e.initGoals,(i=s.value)==null||i.forEach(o=>o.id=Math.random())}catch(o){console.error(o)}});const G={props:e,focusedCell:m,goalsList:s,categoriesData:t,emit:d,getSectionLastDate:g,doMove:n,onMove:v,ref:_,onMounted:D,GoalsTree:x,AddGoalFromTimeline:O,get timelineCategories(){return S},get findBestTimelineCategory(){return A}};return Object.defineProperty(G,"__isScriptSetup",{enumerable:!1,value:!0}),G}},E={class:"category"},K={class:"hint"};function N(p,a,f,e,m,s){return r(),c("table",null,[u("thead",null,[u("tr",null,[a[1]||(a[1]=u("th",{class:"category"},null,-1)),(r(!0),c(C,null,k(e.goalsList,t=>(r(),c("th",{key:t.title},b(t.title),1))),128))])]),u("tbody",null,[(r(!0),c(C,null,k(e.categoriesData,t=>(r(),c("tr",{key:t.title},[u("td",E,[j(b(t.title),1),a[2]||(a[2]=u("br",null,null,-1)),u("span",K,b(t.hint),1)]),(r(!0),c(C,null,k(e.goalsList,(d,g)=>(r(),c("td",{class:V(["goals",e.focusedCell==d.title+t.title?"focused":""]),key:d.id},[(r(),h(e.GoalsTree,{initGoals:d.goals.filter(n=>e.findBestTimelineCategory(n.tags)==t.title),key:d.goals.length,moveConfig:{mode:"timeline",onMove:({goal:n,direction:v})=>e.onMove(n,v,g)},onDateChange:a[0]||(a[0]=n=>e.emit("dateChange")),baseGoalProps:{tags:[t.title],targetDate:e.getSectionLastDate(d)},onCreate:n=>d.goals.push(n)},null,8,["initGoals","moveConfig","baseGoalProps","onCreate"]))],2))),128))]))),128)),u("tr",null,[a[3]||(a[3]=u("td",{class:"category"},null,-1)),(r(!0),c(C,null,k(e.goalsList,(t,d)=>(r(),c("td",{class:"goals",key:t.id},[(r(),h(e.GoalsTree,{initGoals:t.goals.filter(g=>!e.findBestTimelineCategory(g.tags)),key:t.goals.length,moveConfig:{mode:"timeline",onMove:({goal:g,direction:n})=>e.onMove(g,n,d)}},null,8,["initGoals","moveConfig"]))]))),128))])])])}const z=M(F,[["render",N],["__scopeId","data-v-24e0b295"],["__file","C:/Projects/GoalsConnected/goals-connected/src/components/GoalsTimeline.vue"]]),U={__name:"TimelineView",setup(p,{expose:a}){a();const f=B.getBackend(),e=_(0);function m(){e.value+=1}const s={backend:f,refreshKey:e,onDateChange:m,ref:_,GoalsTimeline:z,get BackendSelector(){return B}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}};function W(p,a,f,e,m,s){return r(),h(e.GoalsTimeline,{backend:e.backend,key:e.refreshKey,onDateChange:e.onDateChange},null,8,["backend"])}const H=M(U,[["render",W],["__file","C:/Projects/GoalsConnected/goals-connected/src/views/TimelineView.vue"]]);export{H as default};
