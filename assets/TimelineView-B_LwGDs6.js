import{_ as M,c,o as r,e as u,F as p,r as b,t as v,f as j,n as V,a as h,b as _,d as D,A as x,G as O,g as S,h as A,B}from"./index-BzrlEHzp.js";const F={__name:"GoalsTimeline",props:{initGoals:{type:Array,default(){return[{title:"Week",goals:[]},{title:"Month",goals:[]}]}},backend:Object},emits:["dateChange"],setup(C,{expose:a,emit:f}){a();const e=C,m=_(void 0),s=_(void 0),t=S,g=f,i=l=>new Date((Date.parse(l==null?void 0:l.end)||Date.now())-1).toISOString().split("T")[0];function n(l,d,o,w){let y=l[o],L=y.goals.findIndex(({id:P})=>P==d.id);y.goals.splice(L,1);let T=l[w];d.targetDate=i(T),T.goals.push(d),e.backend.updateGoal(d)}function k(l,d,o){switch(d){case"right":o<s.value.length-1&&n(s.value,l,o,o+1);break;case"left":o>0&&n(s.value,l,o,o-1);break;default:console.error("Unsupported direction: ",d)}}D(async()=>{var l,d;try{s.value=(l=e.backend)!=null&&l.getTimeline?await e.backend.getTimeline():e.initGoals,(d=s.value)==null||d.forEach(o=>o.id=Math.random())}catch(o){console.error(o)}});const G={props:e,focusedCell:m,goalsList:s,categoriesData:t,emit:g,getSectionLastDate:i,doMove:n,onMove:k,ref:_,onMounted:D,GoalsTree:O,AddGoalFromTimeline:x,get timelineCategories(){return S},get findBestTimelineCategory(){return A}};return Object.defineProperty(G,"__isScriptSetup",{enumerable:!1,value:!0}),G}},E={class:"category"},K={class:"hint"};function N(C,a,f,e,m,s){return r(),c("table",null,[u("thead",null,[u("tr",null,[a[2]||(a[2]=u("th",{class:"category"},null,-1)),(r(!0),c(p,null,b(e.goalsList,t=>(r(),c("th",{key:t.title},v(t.title),1))),128))])]),u("tbody",null,[(r(!0),c(p,null,b(e.categoriesData,t=>(r(),c("tr",{key:t.title},[u("td",E,[j(v(t.title),1),a[3]||(a[3]=u("br",null,null,-1)),u("span",K,v(t.hint),1)]),(r(!0),c(p,null,b(e.goalsList,(g,i)=>(r(),c("td",{class:V(["goals",e.focusedCell==g.title+t.title?"focused":""]),key:g.id},[(r(),h(e.GoalsTree,{initGoals:g.goals.filter(n=>e.findBestTimelineCategory(n.tags)==t.title),key:g.goals.length,moveConfig:{mode:"timeline",onMove:({goal:n,direction:k})=>e.onMove(n,k,i)},onDateChange:a[0]||(a[0]=n=>e.emit("dateChange")),baseGoalProps:{tags:[t.title],targetDate:e.getSectionLastDate(g)},onCreate:n=>g.goals.push(n)},null,8,["initGoals","moveConfig","baseGoalProps","onCreate"]))],2))),128))]))),128)),u("tr",null,[a[4]||(a[4]=u("td",{class:"category"},null,-1)),(r(!0),c(p,null,b(e.goalsList,(t,g)=>(r(),c("td",{class:"goals",key:t.id},[(r(),h(e.GoalsTree,{initGoals:t.goals.filter(i=>!e.findBestTimelineCategory(i.tags)),key:t.goals.length,moveConfig:{mode:"timeline",onMove:({goal:i,direction:n})=>e.onMove(i,n,g)},onDateChange:a[1]||(a[1]=i=>e.emit("dateChange")),baseGoalProps:{targetDate:e.getSectionLastDate(t)},onCreate:i=>t.goals.push(i)},null,8,["initGoals","moveConfig","baseGoalProps","onCreate"]))]))),128))])])])}const z=M(F,[["render",N],["__scopeId","data-v-24e0b295"],["__file","C:/Projects/GoalsConnected/goals-connected/src/components/GoalsTimeline.vue"]]),U={__name:"TimelineView",setup(C,{expose:a}){a();const f=B.getBackend(),e=_(0);function m(){e.value+=1}const s={backend:f,refreshKey:e,onDateChange:m,ref:_,GoalsTimeline:z,get BackendSelector(){return B}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}};function W(C,a,f,e,m,s){return r(),h(e.GoalsTimeline,{backend:e.backend,key:e.refreshKey,onDateChange:e.onDateChange},null,8,["backend"])}const H=M(U,[["render",W],["__file","C:/Projects/GoalsConnected/goals-connected/src/views/TimelineView.vue"]]);export{H as default};
