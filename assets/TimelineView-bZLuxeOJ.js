import{B as h,r as _,E as L,_ as T,a as o,d as v,c as u,o as D,e as m,F as C,b as G,t as y,f as F,n as O,g as w,G as V,h as M,i as x}from"./index-CCCRw04C.js";const A={__name:"AddGoalFromTimeline",props:{baseGoalProps:Object,backend:{type:Object,default:h.getBackend()}},emits:["create"],setup(p,{expose:n,emit:f}){n();const e=p,g=f,a=()=>({...e.baseGoalProps,children:void 0,title:"new goal"}),t=_(!1),s=_(void 0);function d(){t.value=!0,s.value=a()}function l(b){b&&(g("create",b),e.backend.create(b).then(r=>b.id=r.id)),t.value=!1}const k={props:e,emit:g,createGoalFromBase:a,editMode:t,goalData:s,startEdit:d,doneEdit:l,ref:_,EditGoal:L,get BackendSelector(){return h}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}};function N(p,n,f,e,g,a){return e.editMode?(o(),v(e.EditGoal,{key:0,onDoneEdit:e.doneEdit,model:e.goalData},null,8,["model"])):(o(),u("div",{key:1,class:"startCreate",onDblclick:e.startEdit,role:"button",id:"add"},"+",32))}const K=T(A,[["render",N],["__file","C:/Projects/GoalsConnected/goals-connected/src/components/AddGoalFromTimeline.vue"]]),z={__name:"GoalsTimeline",props:{initGoals:{type:Array,default(){return[{title:"Week",goals:[]},{title:"Month",goals:[]}]}},backend:Object},emits:["dateChange"],setup(p,{expose:n,emit:f}){n();const e=p,g=_(void 0),a=_(void 0),t=M,s=f,d=r=>new Date((Date.parse(r==null?void 0:r.end)||Date.now())-1).toISOString().split("T")[0];function l(r,c,i,E){let S=r[i],P=S.goals.findIndex(({id:j})=>j==c.id);S.goals.splice(P,1);let B=r[E];c.targetDate=d(B),B.goals.push(c),e.backend.updateGoal(c)}function k(r,c,i){switch(c){case"right":i<a.value.length-1&&l(a.value,r,i,i+1);break;case"left":i>0&&l(a.value,r,i,i-1);break;default:console.error("Unsupported direction: ",c)}}D(async()=>{var r,c;try{a.value=(r=e.backend)!=null&&r.getTimeline?await e.backend.getTimeline():e.initGoals,(c=a.value)==null||c.forEach(i=>i.id=Math.random())}catch(i){console.error(i)}});const b={props:e,focusedCell:g,goalsList:a,categoriesData:t,emit:s,getSectionLastDate:d,doMove:l,onMove:k,ref:_,onMounted:D,GoalsTree:V,AddGoalFromTimeline:K,get timelineCategories(){return M},get findBestTimelineCategory(){return x}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},U={class:"category"},W={class:"hint"};function q(p,n,f,e,g,a){return o(),u("table",null,[m("thead",null,[m("tr",null,[n[1]||(n[1]=m("th",{class:"category"},null,-1)),(o(!0),u(C,null,G(e.goalsList,t=>(o(),u("th",{key:t.title},y(t.title),1))),128))])]),m("tbody",null,[(o(!0),u(C,null,G(e.categoriesData,t=>(o(),u("tr",{key:t.title},[m("td",U,[F(y(t.title),1),n[2]||(n[2]=m("br",null,null,-1)),m("span",W,y(t.hint),1)]),(o(!0),u(C,null,G(e.goalsList,(s,d)=>(o(),u("td",{class:O(["goals",e.focusedCell==s.title+t.title?"focused":""]),key:s.id},[(o(),v(e.GoalsTree,{initGoals:s.goals.filter(l=>e.findBestTimelineCategory(l.tags)==t.title),key:s.goals.length,moveConfig:{mode:"timeline",onMove:({goal:l,direction:k})=>e.onMove(l,k,d)},onDateChange:n[0]||(n[0]=l=>e.emit("dateChange"))},null,8,["initGoals","moveConfig"])),d!=e.goalsList.length-1?(o(),v(e.AddGoalFromTimeline,{key:0,baseGoalProps:{tags:[t.title],targetDate:e.getSectionLastDate(s)},onCreate:l=>s.goals.push(l)},null,8,["baseGoalProps","onCreate"])):w("v-if",!0)],2))),128))]))),128)),m("tr",null,[n[3]||(n[3]=m("td",{class:"category"},null,-1)),(o(!0),u(C,null,G(e.goalsList,(t,s)=>(o(),u("td",{class:"goals",key:t.id},[(o(),v(e.GoalsTree,{initGoals:t.goals.filter(d=>!e.findBestTimelineCategory(d.tags)),key:t.goals.length,moveConfig:{mode:"timeline",onMove:({goal:d,direction:l})=>e.onMove(d,l,s)}},null,8,["initGoals","moveConfig"]))]))),128))])])])}const H=T(z,[["render",q],["__scopeId","data-v-24e0b295"],["__file","C:/Projects/GoalsConnected/goals-connected/src/components/GoalsTimeline.vue"]]),J={__name:"TimelineView",setup(p,{expose:n}){n();const f=h.getBackend(),e=_(0);function g(){e.value+=1}const a={backend:f,refreshKey:e,onDateChange:g,ref:_,GoalsTimeline:H,get BackendSelector(){return h}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}};function Q(p,n,f,e,g,a){return o(),v(e.GoalsTimeline,{backend:e.backend,key:e.refreshKey,onDateChange:e.onDateChange},null,8,["backend"])}const X=T(J,[["render",Q],["__file","C:/Projects/GoalsConnected/goals-connected/src/views/TimelineView.vue"]]);export{X as default};
