import{B as G,r as p,E as P,_ as T,a as l,d as b,c as f,o as S,e as m,F as k,b as v,t as C,f as j,n as L,g as F,G as O,h as B,i as w}from"./index-TBjf7Fnj.js";const V={__name:"AddGoalFromTimeline",props:{baseGoalProps:Object,backend:{type:Object,default:G.getBackend()}},emits:["create"],setup(g,{expose:r,emit:c}){r();const e=g,i=c,_=()=>({...e.baseGoalProps,children:void 0,title:"new goal"}),t=p(!1),o=p(void 0);function u(){t.value=!0,o.value=_()}function d(a){a&&(i("create",a),e.backend.create(a).then(s=>a.id=s.id)),t.value=!1}const n={props:e,emit:i,createGoalFromBase:_,editMode:t,goalData:o,startEdit:u,doneEdit:d,ref:p,EditGoal:P,get BackendSelector(){return G}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}};function x(g,r,c,e,i,_){return e.editMode?(l(),b(e.EditGoal,{key:0,onDoneEdit:e.doneEdit,model:e.goalData},null,8,["model"])):(l(),f("div",{key:1,class:"startCreate",onDblclick:e.startEdit,role:"button",id:"add"},"+",32))}const A=T(V,[["render",x],["__file","C:/Projects/GoalsConnected/goals-connected/src/components/AddGoalFromTimeline.vue"]]),N={__name:"GoalsTimeline",props:{initGoals:{type:Array,default(){return[{title:"Week",goals:[]},{title:"Month",goals:[]}]}},backend:Object},setup(g,{expose:r}){r();const c=g,e=p(void 0),i=p(void 0),_=B,t=n=>new Date((Date.parse(n==null?void 0:n.end)||Date.now())-1).toISOString().split("T")[0];function o(n,a,s,D){let y=n[s],M=y.goals.findIndex(({id:E})=>E==a.id);y.goals.splice(M,1);let h=n[D];a.targetDate=t(h),h.goals.push(a),c.backend.updateGoal(a)}function u(n,a,s){switch(a){case"right":s<i.value.length-1&&o(i.value,n,s,s+1);break;case"left":s>0&&o(i.value,n,s,s-1);break;default:console.error("Unsupported direction: ",a)}}S(async()=>{var n,a;try{i.value=(n=c.backend)!=null&&n.getTimeline?await c.backend.getTimeline():c.initGoals,(a=i.value)==null||a.forEach(s=>s.id=Math.random())}catch(s){console.error(s)}});const d={props:c,focusedCell:e,goalsList:i,categoriesData:_,getSectionLastDate:t,doMove:o,onMove:u,ref:p,onMounted:S,GoalsTree:O,AddGoalFromTimeline:A,get timelineCategories(){return B},get findBestTimelineCategory(){return w}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}},z={class:"category"},U={class:"hint"};function W(g,r,c,e,i,_){return l(),f("table",null,[m("thead",null,[m("tr",null,[r[0]||(r[0]=m("th",{class:"category"},null,-1)),(l(!0),f(k,null,v(e.goalsList,t=>(l(),f("th",{key:t.title},C(t.title),1))),128))])]),m("tbody",null,[(l(!0),f(k,null,v(e.categoriesData,t=>(l(),f("tr",{key:t.title},[m("td",z,[j(C(t.title),1),r[1]||(r[1]=m("br",null,null,-1)),m("span",U,C(t.hint),1)]),(l(!0),f(k,null,v(e.goalsList,(o,u)=>(l(),f("td",{class:L(["goals",e.focusedCell==o.title+t.title?"focused":""]),key:o.id},[(l(),b(e.GoalsTree,{initGoals:o.goals.filter(d=>e.findBestTimelineCategory(d.tags)==t.title),key:o.goals.length,moveConfig:{mode:"timeline",onMove:({goal:d,direction:n})=>e.onMove(d,n,u)}},null,8,["initGoals","moveConfig"])),u!=e.goalsList.length-1?(l(),b(e.AddGoalFromTimeline,{key:0,baseGoalProps:{tags:[t.title],targetDate:e.getSectionLastDate(o)},onCreate:d=>o.goals.push(d)},null,8,["baseGoalProps","onCreate"])):F("v-if",!0)],2))),128))]))),128)),m("tr",null,[r[2]||(r[2]=m("td",{class:"category"},null,-1)),(l(!0),f(k,null,v(e.goalsList,(t,o)=>(l(),f("td",{class:"goals",key:t.id},[(l(),b(e.GoalsTree,{initGoals:t.goals.filter(u=>!e.findBestTimelineCategory(u.tags)),key:t.goals.length,moveConfig:{mode:"timeline",onMove:({goal:u,direction:d})=>e.onMove(u,d,o)}},null,8,["initGoals","moveConfig"]))]))),128))])])])}const q=T(N,[["render",W],["__scopeId","data-v-24e0b295"],["__file","C:/Projects/GoalsConnected/goals-connected/src/components/GoalsTimeline.vue"]]),H={__name:"TimelineView",setup(g,{expose:r}){r();const e={backend:G.getBackend(),GoalsTimeline:q,get BackendSelector(){return G}};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}};function J(g,r,c,e,i,_){return l(),b(e.GoalsTimeline,{backend:e.backend},null,8,["backend"])}const Q=T(H,[["render",J],["__file","C:/Projects/GoalsConnected/goals-connected/src/views/TimelineView.vue"]]);export{Q as default};
